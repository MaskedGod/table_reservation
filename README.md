# üçΩÔ∏è Table Reservation API

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ REST API –¥–ª—è **–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç–æ–ª–∏–∫–æ–≤ –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ**. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è–º–∏ –∏ —Å—Ç–æ–ª–∞–º–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –Ω–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –≤–æ –≤—Ä–µ–º–µ–Ω–∏. –ü–æ—Å—Ç—Ä–æ–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ FastAPI —Å —Ä–∞—Å—à–∏—Ä—è–µ–º–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π.

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìÖ CRUD –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π
- üçΩÔ∏è CRUD –¥–ª—è —Å—Ç–æ–ª–∏–∫–æ–≤
- üö´ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π
- üß™ –¢–µ—Å—Ç—ã —Å Pytest –∏ PostgreSQL
- üê≥ Docker + docker-compose
- üîÅ Alembic –º–∏–≥—Ä–∞—Ü–∏–∏
- ‚ôªÔ∏è –†–∞—Å—à–∏—Ä—è–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ generic —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
app/
‚îú‚îÄ‚îÄ core/               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îú‚îÄ‚îÄ dependencies/       # –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π FastAPI
‚îú‚îÄ‚îÄ models/             # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ repositories/       # Generic –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
‚îú‚îÄ‚îÄ routers/            # FastAPI –º–∞—Ä—à—Ä—É—Ç—ã (–µ–Ω–¥–ø–æ–∏–Ω—Ç—ã)
‚îú‚îÄ‚îÄ schemas/            # Pydantic-—Å—Ö–µ–º—ã
‚îú‚îÄ‚îÄ services/           # Generic –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
‚îú‚îÄ‚îÄ migrations/         # Alembic –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ tests/              # Pytest —Ç–µ—Å—Ç—ã –∏ docker-compose –¥–ª—è –Ω–∏—Ö
...
```

---

## üîó API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### üìã –ë—Ä–æ–Ω–∏ (`/reservations`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç              | –û–ø–∏—Å–∞–Ω–∏–µ                                              |
|-------|------------------------|--------------------------------------------------------|
| GET   | `/reservations/`       | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –±—Ä–æ–Ω–µ–π                           |
| POST  | `/reservations/`       | –°–æ–∑–¥–∞—Ç—å –±—Ä–æ–Ω—å (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –Ω–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏)    |
| DELETE| `/reservations/{id}`   | –£–¥–∞–ª–∏—Ç—å –±—Ä–æ–Ω—å –ø–æ ID                                   |

#### üîÅ –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ `POST /reservations/`

```json
{
  "customer_name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "table_id": 1,
  "reservation_time": "2025-04-08T18:00:00",
  "duration_minutes": 90
}
```

> ‚ö†Ô∏è –ü—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `409 Conflict` —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º:  
> `{"detail": "Table is already reserved at this time."}`

---

### ü™ë –°—Ç–æ–ª–∏–∫–∏ (`/tables`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç         | –û–ø–∏—Å–∞–Ω–∏–µ                        |
|-------|------------------|----------------------------------|
| GET   | `/tables/`       | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—Ç–æ–ª–∏–∫–æ–≤   |
| POST  | `/tables/`       | –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å—Ç–æ–ª–∏–∫            |
| DELETE| `/tables/{id}`   | –£–¥–∞–ª–∏—Ç—å —Å—Ç–æ–ª–∏–∫ –ø–æ ID            |

#### üõ† –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ `POST /tables/`

```json
{
  "name": "Table 3",
  "seats": 4,
  "location": "—Ç–µ—Ä—Ä–∞—Å–∞"
}
```

---

## ‚öôÔ∏è –õ–æ–≥–∏–∫–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

- ‚ùå –ù–µ–ª—å–∑—è —Å–æ–∑–¥–∞—Ç—å –±—Ä–æ–Ω—å, –µ—Å–ª–∏ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å—Ç–æ–ª–∏–∫ —É–∂–µ –∑–∞–Ω—è—Ç.
- üïí –£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –º–∏–Ω—É—Ç–∞—Ö (`duration_minutes`).
- ‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ Pydantic-—Å—Ö–µ–º—ã –∏ —Å–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π.

---

## üß† –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å —Å –ø–æ–º–æ—â—å—é –¥–∂–µ–Ω–µ—Ä–∏–∫–æ–≤

### üóÉÔ∏è Generic Repository

–§–∞–π–ª: `repositories/base.py`

```python
class BaseRepository(Generic[ModelType]):
    async def get_all(...) -> list[ModelType]: ...
    async def create(...) -> ModelType: ...
    async def delete(...) -> bool: ...
```

–õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è:

```python
class CustomRepo(BaseRepository[MyModel]):
    ...
```

---

### üß© Generic Service

–§–∞–π–ª: `services/base.py`

```python
class BaseService(Generic[ModelType]):
    def __init__(self, repo: BaseRepository[ModelType]): ...
```

–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:

```python
class MyEntityService(BaseService[MyEntity]):
    ...
```

> –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã—Ö —Å–∏—Å—Ç–µ–º: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π —Ç—Ä–µ–±—É–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞.

---

## üê≥ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

1. **–ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**:

```bash
git clone https://github.com/MaskedGod/table_reservation.git
cd table_reservation
```

2. **–°–∫–æ–ø–∏—Ä—É–π —Ñ–∞–π–ª –æ–∫—Ä—É–∂–µ–Ω–∏—è**:

```bash
cp .env.example .env
```

3. **–ó–∞–ø—É—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é Docker Compose**:

```bash
docker compose up --build
```

4. **API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É**:  
   üìç [http://localhost:8000](http://localhost:8000)

5. **Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É**:  
   üß™ [http://localhost:8000/docs](http://localhost:8000/docs)

---

## ‚úÖ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

1. –ó–∞–ø—É—Å—Ç–∏ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–µ—Å—Ç–æ–≤—É—é –ë–î:

```bash
docker compose -f tests/docker-compose.test.yml up -d
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏ [uv](https://github.com/astral-sh/uv) (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ‚Äî –±—ã—Å—Ç—Ä—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

```bash
pip install uv
```

3. –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
uv sync 
```

–∏–ª–∏

```bash
pip install -r requirements.txt
```

4. –ó–∞–ø—É—Å—Ç–∏ —Ç–µ—Å—Ç—ã:

```bash
pytest -v
```
